<app-navbar></app-navbar>

<main [@routeAnimations]="o.isActivated ? o.activatedRoute : ''">
  <router-outlet #o="outlet"></router-outlet>
</main>

<app-footer></app-footer>
<app-loyalty-popup #loyaltyPopup (opened)="onPopupOpened()" (closed)="onPopupClosed()"></app-loyalty-popup>

<!-- Botones flotantes (WhatsApp + Alianzas) -->
<div class="floating-fabs" *ngIf="showFloating || showAllianceCta">
  <div class="alliance-cta" *ngIf="showAllianceCta" [class.is-minimized]="allianceCtaMinimized">
    <ng-container *ngIf="!allianceCtaMinimized; else allianceFab">
      <div class="cta-content">
        <div class="cta-header">
           <button type="button" class="btn-minimize" (click)="collapseAllianceCta($event)" aria-label="Minimizar">_</button>
        </div>
        <span class="cta-title">Si quieres ser alianza</span>
        <span class="cta-sub">¬°Escr√≠benos!</span>
        <a [href]="allianceFormUrl" class="cta-button">Ir al formulario</a>
      </div>
    </ng-container>
    <ng-template #allianceFab>
      <button type="button" class="alliance-fab" (click)="expandAllianceCta()" aria-label="Abrir aviso de alianzas">ü§ù</button>
    </ng-template>
  </div>

  <a
    *ngIf="showFloating"
    class="whatsapp-button"
    href="https://wa.me/56982512970?text=Hola%2C%20quiero%20reservar%20una%20hora%20en%20Rokos%20Barber%20Club."
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Chatea con nosotros por WhatsApp"
  >
    <img src="assets/wsp.svg" alt="WhatsApp" />
  </a>
</div>
